<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Auto Loan Calculator — Fixvity</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#f7fbfd;
  --card:#ffffff;
  --accent:#1f6fb6;
  --muted:#6b7280;
  --radius:12px;
  --shadow:0 8px 28px rgba(10,20,30,.06);
  --container-max:1100px;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui;background:var(--bg)}
.wrap{max-width:var(--container-max);margin:22px auto;padding:18px}
header h1{margin:0;font-size:36px;color:var(--accent)}
header p{color:var(--muted)}
.card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin-bottom:18px}
.grid{display:grid;gap:18px;grid-template-columns:1fr 430px}
@media(max-width:1024px){.grid{grid-template-columns:1fr}}
label{font-size:14px;color:var(--muted)}
input,select{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:8px}
.form-row{display:flex;gap:12px}
@media(max-width:600px){.form-row{flex-direction:column}}
.btn{padding:10px 16px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
.btn{background:var(--accent);color:#fff}
.btn.alt{background:#eef6fb;color:var(--accent);border:1px solid #dfeffb}
.results{display:flex;flex-direction:column;gap:14px}
.result-row{display:flex;justify-content:space-between;border:1px solid #f1f5f9;padding:12px;border-radius:8px}
.chartBox{height:260px}
.chartBox.tall{height:300px}
.tableWrap{overflow:auto}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #eef2f7}
th{background:#2f6b9f;color:#fff}
.tabBtn{padding:10px 14px;border-radius:8px;border:1px solid #dfe6ee;cursor:pointer}
.tabBtn.active{background:var(--accent);color:#fff}
</style>
</head>

<body>
<div class="wrap">

<header>
<h1>Auto Loan Calculator</h1>
<p>Monthly payment, amortization schedule, charts & printable results.</p>
</header>

<div class="card">
<select id="currencyTop">
<option value="USD">USD ($)</option>
<option value="EUR">EUR (€)</option>
<option value="GBP">GBP (£)</option>
<option value="INR">INR (₹)</option>
</select>

<div class="grid">

<form id="loanForm">
<label>Auto Price</label>
<input id="price" type="number" value="50000">

<div class="form-row">
<div>
<label>Term (months)</label>
<input id="term" type="number" value="60">
</div>
<div>
<label>Interest %</label>
<input id="rate" type="number" value="5">
</div>
</div>

<label>Down Payment</label>
<input id="down" type="number" value="10000">

<label>Sales Tax %</label>
<input id="salesTax" type="number" value="7">

<label>Fees</label>
<input id="fees" type="number" value="2000">

<div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
<button class="btn" id="calc">Calculate</button>
<button class="btn alt" id="reset">Reset</button>
<button class="btn alt" id="printBtn">Print</button>
<button class="btn alt" id="csv">Download CSV</button>
</div>
</form>

<div class="results">
<div class="result-row">
<strong>Total Loan</strong>
<span id="totalLoanVal">$0.00</span>
</div>
<div class="result-row">
<strong>Monthly Payment</strong>
<span id="monthlyVal">$0.00</span>
</div>
<div class="chartBox tall"><canvas id="donut"></canvas></div>
<div class="chartBox"><canvas id="amort"></canvas></div>
</div>

</div>
</div>

<div class="card">
<div style="display:flex;justify-content:space-between">
<h2>Amortization Schedule</h2>
<div>
<button class="tabBtn active" id="btnAnnual">Annual</button>
<button class="tabBtn" id="btnMonthly">Monthly</button>
</div>
</div>
<div id="scheduleWrap" class="tableWrap"></div>
</div>

</div>

<script>
const currencyMap={USD:'en-US',EUR:'de-DE',GBP:'en-GB',INR:'en-IN'};
const $=id=>document.getElementById(id);
let donutChart,amortChart;

function money(v){
return new Intl.NumberFormat(currencyMap[$('currencyTop').value],{
style:'currency',currency:$('currencyTop').value
}).format(v);
}

function createCharts(){
donutChart=new Chart($('donut'),{
type:'doughnut',
data:{labels:['Principal','Interest'],datasets:[{data:[1,1]}]},
options:{responsive:true,maintainAspectRatio:false}
});
amortChart=new Chart($('amort'),{
type:'line',
data:{labels:[],datasets:[
{label:'Balance',data:[]},
{label:'Interest',data:[]}
]},
options:{responsive:true,maintainAspectRatio:false}
});
}

function calculate(){
const price=+price.value,term=+term.value,rate=+rate.value/100/12;
const down=+down.value,tax=+salesTax.value/100,fees=+fees.value;
const loan=(price-down)*(1+tax)+fees;
let payment=rate?loan*(rate/(1-Math.pow(1+rate,-term))):loan/term;

let bal=loan,totalInt=0,schedule=[];
for(let m=1;m<=term;m++){
let interest=bal*rate;
let principal=payment-interest;
bal=Math.max(0,bal-principal);
totalInt+=interest;
schedule.push({m,payment,principal,interest,bal});
}

$('totalLoanVal').textContent=money(loan);
$('monthlyVal').textContent=money(payment);

donutChart.data.datasets[0].data=[loan,totalInt];
donutChart.update();

amortChart.data.labels=schedule.map(r=>r.m);
amortChart.data.datasets[0].data=schedule.map(r=>r.bal);
amortChart.data.datasets[1].data=schedule.map(r=>r.interest);
amortChart.update();

buildTables(schedule);
}

function buildTables(monthly){
let annual={},html='';
monthly.forEach(r=>{
let y=Math.ceil(r.m/12);
annual[y]=(annual[y]||0)+r.interest;
});
html='<div id="annualTable"><table><tr><th>Year</th><th>Interest</th></tr>';
for(let y in annual)html+=`<tr><td>${y}</td><td>${money(annual[y])}</td></tr>`;
html+='</table></div>';

html+='<div id="monthlyTable" style="display:none"><table><tr><th>Month</th><th>Payment</th><th>Balance</th></tr>';
monthly.forEach(r=>html+=`<tr><td>${r.m}</td><td>${money(r.payment)}</td><td>${money(r.bal)}</td></tr>`);
html+='</table></div>';

$('scheduleWrap').innerHTML=html;

btnAnnual.onclick=()=>{annualTable.style.display='block';monthlyTable.style.display='none'};
btnMonthly.onclick=()=>{annualTable.style.display='none';monthlyTable.style.display='block'};

csv.onclick=()=>{
const rows=[['Month','Payment','Balance']];
monthly.forEach(r=>rows.push([r.m,r.payment.toFixed(2),r.bal.toFixed(2)]));
const blob=new Blob([rows.map(r=>r.join(',')).join('\n')],{type:'text/csv'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='auto_loan.csv';
a.click();
};
}

calc.onclick=e=>{e.preventDefault();calculate()};
reset.onclick=e=>{e.preventDefault();location.reload()};
printBtn.onclick=()=>print();

createCharts();
calculate();
</script>
</body>
</html>
